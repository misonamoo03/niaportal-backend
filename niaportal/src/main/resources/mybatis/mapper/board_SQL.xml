<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.misonamoo.niaportal.mapper.BoardMapper">

    <resultMap id="BoardContentMap" type="BoardContent">
        <result property="boardContentNo" column="BOARD_CONTENT_NO" />
        <result property="userNo" column="USER_NO" />
        <result property="boardNo" column="BOARD_NO" />
        <result property="orgBoardContentNo" column="ORG_BOARD_CONTENT_NO" />
        <result property="title" column="TITLE" />
        <result property="content" column="CONTENT" />
        <result property="secYn" column="SEC_YN" />
        <result property="viewCnt" column="VIEW_CNT" />
        <result property="regDate" column="REG_DATE" />
        <result property="updDate" column="UPD_DATE" />
        <result property="replyYn" column="REPLY_YN" />
    </resultMap>

    <select id="getBoardwithPagination" resultMap="BoardContentMap">
        <!-- 애스터리스크(x) 필요한 컬럼만 리턴(연동 규격서 참고)-->
        select * from bizmiso.AI_BOARD_CONTENT limit #{pageSize} offset #{offsetNum}
    </select>

    <select id="getBoardTotalCount" resultType="Integer">
        select count(*) from bizmiso.AI_BOARD_CONTENT
    </select>
    <select id="getBoardList" resultMap="BoardContentMap">
            SELECT *
              FROM bizmiso.AI_BOARD_CONTENT
    </select>

    <select id="getBoard" parameterType="BoardContent" resultMap="BoardContentMap">
        <!-- 애스터리스트(x) 필요한 컬럼만 리턴 -->
        select * from bizmiso.AI_BOARD_CONTENT where BOARD_CONTENT_NO = #{boardContentNo}
    </select>

    <insert id="insertBoard" parameterType="BoardContent" >
        <selectKey resultType="Long" keyProperty="boardContentNo" order="BEFORE">
            select MAX(BOARD_CONTENT_NO) + 1 as SEQUENCE_NUMBER FROM bizmiso.AI_BOARD_CONTENT
        </selectKey>
        INSERT INTO bizmiso.AI_BOARD_CONTENT (
            BOARD_CONTENT_NO,
            USER_NO,
            BOARD_NO,
            ORG_BOARD_CONTENT_NO,
            TITLE,
            CONTENT,
            SEC_YN,
            VIEW_CNT,
            REG_DATE,
            UPD_DATE,
            REPLY_YN
        ) VALUES (
            #{boardContentNo},
            #{userNo},
            #{boardNo},
            #{orgBoardContentNo},
            #{title},
            #{content},
            'N',
            0,
            sysdate(),
            sysdate(),
            'N'
        )
    </insert>

    <update id="updateBoard" parameterType="BoardContent" >
        UPDATE bizmiso.AI_BOARD_CONTENT
        <trim prefix="SET" suffixOverrides=",">
            <if test='title != null and title != "null" and title != ""'>
                TITLE = #{title},
            </if>
            <if test='content != null and content != "null" and content != ""'>
                CONTENT = #{content},
            </if>
        </trim>
        WHERE BOARD_CONTENT_NO = #{boardContentNo}
    </update>

    <delete id="deleteBoard" parameterType="Long">
        delete from bizmiso.AI_BOARD_CONTENT where BOARD_CONTENT_NO = #{boardContentNo}
    </delete>

</mapper>