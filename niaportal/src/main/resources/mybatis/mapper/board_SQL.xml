<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.misonamoo.niaportal.mapper.BoardMapper">

    <resultMap id="BoardMap" type="Board">
        <result property="boardSeq" column="BOARD_SEQ" />
        <result property="boardTitle" column="BOARD_TITLE" />
        <result property="boardContent" column="BOARD_CONTENT" />
        <result property="boardRegistDate" column="BOARD_REGIST_DATE" />
    </resultMap>

    <select id="getBoardwithPagination" resultMap="BoardMap">
        select * from bizmiso.POSTER_BOARD limit #{limit} offset #{offset}
    </select>

    <select id="getBoardTotalCount" resultType="Integer">
        select count(*) from bizmiso.POSTER_BOARD
    </select>
    <select id="getBoardList" resultMap="BoardMap">
            SELECT *
              FROM bizmiso.POSTER_BOARD
    </select>

    <select id="getBoard" parameterType="Board" resultMap="BoardMap">
        select * from bizmiso.POSTER_BOARD where BOARD_SEQ = #{boardSeq}
    </select>

    <insert id="insertBoard" parameterType="BoardParameter" >
        <selectKey resultType="Long" keyProperty="boardSeq" order="BEFORE">
            select MAX(BOARD_SEQ) + 1 as SEQUENCE_NUMBER FROM bizmiso.POSTER_BOARD
        </selectKey>
        INSERT INTO bizmiso.POSTER_BOARD (
            BOARD_TITLE,
            BOARD_CONTENT,
            BOARD_REGIST_DATE
        ) VALUES (
            #{boardTitle},
            #{boardContent},
            SYSDATE()
        )
    </insert>

    <update id="updateBoard" parameterType="BoardParameter" >
        UPDATE bizmiso.POSTER_BOARD
        <trim prefix="SET" suffixOverrides=",">
            <if test='boardTitle != null and boardTitle != "null" and boardTitle != ""'>
                BOARD_TITLE = #{boardTitle},
            </if>
            <if test='boardContent != null and boardContent != "null" and boardContent != ""'>
                BOARD_CONTENT = #{boardContent},
            </if>
        </trim>
        WHERE BOARD_SEQ = #{boardSeq}
    </update>

    <delete id="deleteBoard" parameterType="Long">
        delete from bizmiso.POSTER_BOARD where BOARD_SEQ = #{boardSeq}
    </delete>

</mapper>